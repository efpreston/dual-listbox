(()=>{var v="dual-listbox",p="dual-listbox__container",E="dual-listbox__available",m="dual-listbox__selected",f="dual-listbox__disabled",r="dual-listbox__title",c="dual-listbox__item",x="dual-listbox__buttons",T="dual-listbox__button",u="dual-listbox__search",b="dual-listbox__label",n="dual-listbox__item--selected",_="up",L="down",d=class{constructor(e,t={}){this.setDefaults(),this.selected=[],this.available=[],d.isDomElement(e)?this.select=e:this.select=document.querySelector(e),this._initOptions(t),this._initReusableElements(),this._splitOptions(this.select.options),t.options!==void 0&&this._splitOptions(t.options),this._buildDualListbox(this.select.parentNode),this._addActions(),this.sortable&&this._initializeSortButtons(),this.redraw()}setDefaults(){this.addEvent=null,this.removeEvent=null,this.availableTitle="Available options",this.selectedTitle="Selected options",this.showAddButton=!0,this.addButtonText="add",this.showRemoveButton=!0,this.removeButtonText="remove",this.showAddAllButton=!0,this.addAllButtonText="add all",this.showRemoveAllButton=!0,this.removeAllButtonText="remove all",this.searchPlaceholder="Search",this.selectedLabel="",this.availableLabel="",this.sortable=!1,this.upButtonText="up",this.downButtonText="down"}addEventListener(e,t){this.dualListbox.addEventListener(e,t)}addSelected(e){let t=this.available.indexOf(e);t>-1&&(this.available.splice(t,1),this.selected.push(e),this._selectOption(e.dataset.id),this._updateSelectedlabel(this.selected.length),this._updateAvailablelabel(this.available.length),this.redraw(),setTimeout(()=>{let i=document.createEvent("HTMLEvents");i.initEvent("added",!1,!0),i.addedElement=e,this.dualListbox.dispatchEvent(i)},0))}redraw(){this.updateAvailableListbox(),this.updateSelectedListbox(),this.updateSelectedLabel(),this.updateAvailableLabel()}removeSelected(e){let t=this.selected.indexOf(e);t>-1&&(this.selected.splice(t,1),this.available.push(e),this._deselectOption(e.dataset.id),this._updateSelectedlabel(this.selected.length),this._updateAvailablelabel(this.available.length),this.redraw(),setTimeout(()=>{let i=document.createEvent("HTMLEvents");i.initEvent("removed",!1,!0),i.removedElement=e,this.dualListbox.dispatchEvent(i)},0))}searchLists(e,t){let i=t.querySelectorAll(`.${c}`),s=e.toLowerCase();for(let l=0;l<i.length;l++){let a=i[l];a.textContent.toLowerCase().indexOf(s)===-1?a.style.display="none":a.style.display="list-item"}}updateAvailableListbox(){this._updateListbox(this.availableList,this.available)}updateSelectedListbox(){this._updateListbox(this.selectedList,this.selected)}updateSelectedLabel(){this._updateSelectedlabel(this.selected.length)}updateAvailableLabel(){this._updateAvailablelabel(this.available.length)}_actionAllSelected(e){e.preventDefault(),this.available.filter(i=>i.style.display!=="none").forEach(i=>this.addSelected(i))}_updateListbox(e,t){for(;e.firstChild;)e.removeChild(e.firstChild);for(let i=0;i<t.length;i++){let s=t[i];e.appendChild(s)}}_updateSelectedlabel(e){this.selected_label&&(this.selected_label.innerText=e+this.selectedLabel)}_updateAvailablelabel(e){this.available_label&&(this.available_label.innerText=e+this.availableLabel)}_actionItemSelected(e){e.preventDefault();let t=this.dualListbox.querySelector(`.${n}`);t&&this.addSelected(t)}_actionAllDeselected(e){e.preventDefault(),this.selected.filter(i=>i.style.display!=="none").forEach(i=>this.removeSelected(i))}_actionItemDeselected(e){e.preventDefault();let t=this.dualListbox.querySelector(`.${n}`);t&&this.removeSelected(t)}_actionItemDoubleClick(e,t=null){t&&(t.preventDefault(),t.stopPropagation()),this.selected.indexOf(e)>-1?this.removeSelected(e):this.addSelected(e)}_actionItemClick(e,t,i=null){i&&i.preventDefault();let s=t.querySelectorAll(`.${c}`);for(let l=0;l<s.length;l++){let a=s[l];a!==e&&a.classList.remove(n)}e.classList.contains(n)?e.classList.remove(n):e.classList.add(n)}_addActions(){this._addButtonActions(),this._addSearchActions()}_addButtonActions(){this.add_all_button.addEventListener("click",e=>this._actionAllSelected(e)),this.add_button.addEventListener("click",e=>this._actionItemSelected(e)),this.remove_button.addEventListener("click",e=>this._actionItemDeselected(e)),this.remove_all_button.addEventListener("click",e=>this._actionAllDeselected(e))}_addClickActions(e){return e.addEventListener("dblclick",t=>this._actionItemDoubleClick(e,t)),e.addEventListener("click",t=>this._actionItemClick(e,this.dualListbox,t)),e}_addSearchActions(){this.search_left.addEventListener("change",e=>this.searchLists(e.target.value,this.availableList)),this.search_left.addEventListener("keyup",e=>this.searchLists(e.target.value,this.availableList)),this.search_right.addEventListener("change",e=>this.searchLists(e.target.value,this.selectedList)),this.search_right.addEventListener("keyup",e=>this.searchLists(e.target.value,this.selectedList))}_buildDualListbox(e){this.select.style.display="none",this.dualListBoxContainer.appendChild(this._createList(this.search_left,this.availableListTitle,this.availableList,this.available_label)),this.dualListBoxContainer.appendChild(this.buttons);let t=this.selected_label;this.dualListBoxContainer.appendChild(this._createList(this.search_right,this.selectedListTitle,this.selectedList,this.selected_label)),this.dualListbox.appendChild(this.dualListBoxContainer),e.insertBefore(this.dualListbox,this.select)}_createList(e,t,i,s){let l=document.createElement("div");return l.appendChild(e),l.appendChild(t),l.appendChild(i),s&&l.appendChild(s),l}_createButtons(){this.buttons=document.createElement("div"),this.buttons.classList.add(x),this.add_all_button=document.createElement("button"),this.add_all_button.innerHTML=this.addAllButtonText,this.add_button=document.createElement("button"),this.add_button.innerHTML=this.addButtonText,this.remove_button=document.createElement("button"),this.remove_button.innerHTML=this.removeButtonText,this.remove_all_button=document.createElement("button"),this.remove_all_button.innerHTML=this.removeAllButtonText;let e={showAddAllButton:this.add_all_button,showAddButton:this.add_button,showRemoveButton:this.remove_button,showRemoveAllButton:this.remove_all_button};for(let t in e)if(t){let i=this[t],s=e[t];s.setAttribute("type","button"),s.classList.add(T),i&&this.buttons.appendChild(s)}}_createListItem(e){let t=document.createElement("li");return t.classList.add(c),t.innerHTML=e.text,t.dataset.id=e.value,e.disabled?t.classList.add(f):this._addClickActions(t),t}_createSearchLeft(){this.search_left=document.createElement("input"),this.search_left.classList.add(u),this.search_left.placeholder=this.searchPlaceholder}_createSearchRight(){this.search_right=document.createElement("input"),this.search_right.classList.add(u),this.search_right.placeholder=this.searchPlaceholder}_createSelectedLabel(){this.selected_label=document.createElement("label"),this.selected_label.classList.add(b),this.selected_label.innerText=this.selected.length+this.selectedLabel}_createAvailableLabel(){this.available_label=document.createElement("label"),this.available_label.classList.add(b),this.available_label.innerText=this.available.length+this.availableLabel}_deselectOption(e){let t=this.select.options;for(let i=0;i<t.length;i++){let s=t[i];s.value===e&&(s.selected=!1,s.removeAttribute("selected"))}this.removeEvent&&this.removeEvent(e)}_initOptions(e){for(let t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}_initReusableElements(){this.dualListbox=document.createElement("div"),this.dualListbox.classList.add(v),this.select.id&&this.dualListbox.classList.add(this.select.id),this.dualListBoxContainer=document.createElement("div"),this.dualListBoxContainer.classList.add(p),this.availableList=document.createElement("ul"),this.availableList.classList.add(E),this.selectedList=document.createElement("ul"),this.selectedList.classList.add(m),this.availableListTitle=document.createElement("div"),this.availableListTitle.classList.add(r),this.availableListTitle.innerText=this.availableTitle,this.selectedListTitle=document.createElement("div"),this.selectedListTitle.classList.add(r),this.selectedListTitle.innerText=this.selectedTitle,this._createButtons(),this._createSearchLeft(),this._createSearchRight(),this.selectedLabel&&this._createSelectedLabel(),this.availableLabel&&this._createAvailableLabel()}_selectOption(e){let t=this.select.options;for(let i=0;i<t.length;i++){let s=t[i];s.value===e&&(s.selected=!0,s.setAttribute("selected",""))}this.addEvent&&this.addEvent(e)}_splitOptions(e){for(let t=0;t<e.length;t++){let i=e[t];d.isDomElement(i)?this._addOption({text:i.innerHTML,value:i.value,selected:i.attributes.selected,disabled:i.attributes.disabled}):this._addOption(i)}}_addOption(e){let t=this._createListItem(e);e.selected?this.selected.push(t):this.available.push(t)}_initializeSortButtons(){let e=document.createElement("button");e.classList.add("dual-listbox__button"),e.innerText=this.upButtonText,e.addEventListener("click",s=>this._onSortButtonClick(s,_));let t=document.createElement("button");t.classList.add("dual-listbox__button"),t.innerText=this.downButtonText,t.addEventListener("click",s=>this._onSortButtonClick(s,L));let i=document.createElement("div");i.classList.add("dual-listbox__buttons"),i.appendChild(e),i.appendChild(t),this.dualListBoxContainer.appendChild(i)}_onSortButtonClick(e,t){e.preventDefault();let[i,s]=this._findSelected(t);i!==s&&(this._sortUnderlyingSelectOptions(i,s),this._sortSelected(i,s),this.redraw())}_findSelected(e){let t=this.selected.findIndex(s=>s.classList.contains("dual-listbox__item--selected")),i=t;return _===e&&t>0?i-=1:L===e&&t<this.selected.length-1&&(i+=1),[t,i]}_sortUnderlyingSelectOptions(e,t){let i=this.selected[e].getAttribute("data-id"),s=this.selected[t].getAttribute("data-id"),l=[...this.select.children].findIndex(o=>o.value===i),a=[...this.select.children].findIndex(o=>o.value===s),h=this.select.children[l];h.remove(),this.select.insertBefore(h,this.select.children[a])}_sortSelected(e,t){let i=this.selected[e];this.selected.splice(e,1),this.selected.splice(t,0,i)}static isDomElement(e){return typeof HTMLElement=="object"?e instanceof HTMLElement:e&&typeof e=="object"&&e!==null&&e.nodeType===1&&typeof e.nodeName=="string"}};window.DualListbox=d;var S=d;})();
//# sourceMappingURL=dual-listbox.js.map
